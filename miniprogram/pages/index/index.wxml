<!-- pages/index/index.wxml - 持仓列表页 -->

<view class="container">
  <!-- 总资产卡片 -->
  <view class="card summary-card">
    <view class="summary-header">
      <text class="summary-label">总资产</text>
      <text class="summary-value">{{formattedTotalValue}}</text>
    </view>
    <view class="summary-details">
      <view class="summary-item">
        <text class="summary-item-label">总成本</text>
        <text class="summary-item-value">{{formattedTotalCost}}</text>
      </view>
      <view class="summary-item">
        <text class="summary-item-label">总盈亏</text>
        <text class="summary-item-value {{totalProfitClass}}">
          {{formattedTotalProfit}}
          <text wx:if="{{formattedTotalProfitPercent !== '0.00%'}}">{{formattedTotalProfitPercent}}</text>
        </text>
      </view>
    </view>
  </view>

  <!-- 持仓列表 -->
  <view class="card position-list">
    <view wx:if="{{!loading && positions.length === 0}}" class="empty-state">
      <text class="empty-text">暂无持仓</text>
      <text class="empty-hint">点击下方"添加"按钮开始</text>
    </view>

    <view wx:for="{{positions}}" wx:key="_id" class="position-item" bindtap="onViewPosition" data-id="{{item._id}}">
      <view class="position-header">
        <view class="position-info">
          <text class="position-name">{{item.stockName}}</text>
          <text class="position-code">{{item.formattedCode}}</text>
        </view>
        <view class="position-value">
          <text class="value-amount">{{item.formattedValue}}</text>
        </view>
      </view>

      <view class="position-details">
        <view class="detail-item">
          <text class="detail-label">持仓</text>
          <text class="detail-value">{{item.quantity}}股</text>
        </view>
        <view class="detail-item">
          <text class="detail-label">成本价</text>
          <text class="detail-value">{{item.formattedCost}}</text>
        </view>
        <view class="detail-item">
          <text class="detail-label">现价</text>
          <text class="detail-value {{item.profitClass}}">
            {{item.formattedCurrentPrice}}
          </text>
        </view>
        <view class="detail-item">
          <text class="detail-label">盈亏</text>
          <text class="detail-value {{item.profitClass}}">
            {{item.formattedProfit}}
          </text>
        </view>
      </view>
    </view>

    <view wx:if="{{loading}}" class="loading">
      <text>加载中...</text>
    </view>
  </view>
</view>
